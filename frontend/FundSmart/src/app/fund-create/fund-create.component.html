<div class="right-panel-wrap no-padding-right">
    <div class="dashboard-content">
        <div class="row ">
            <div class="col-lg-12">
                <div class="block-container">
                    <div class="head-global">
                        <h3>Fund <span>Create</span></h3>
                    </div>
                    <div class="row align-items-center ml-2 mr-2">
                        <div class="col-sm-9">
                            <div class="date-picker-wrap">
                                <div class="input-group">
                                    <label style="color: #000034">Portfolio Date</label>
                                    <input class="form-control " placeholder="yyyy-mm-dd" [(ngModel)]="selectedDate"
                                        #c="ngModel" ngbDatepicker #d="ngbDatepicker" [(maxDate)]="maxdate"
                                        (dateSelect)="onDateSelect($event)">
                                    <div class="input-group-append">
                                        <button type="button" (click)="d.toggle()">
                                            <i class="fa fa-calendar"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-3">
                            <div *ngIf="portfoliolist.length > 1">
                                <div class='input-group align-items-center' style="color: #000034">
                                    Select Portfolio:<select class='form-control ml-2' [(ngModel)]="serchportfolio"
                                        (change)='getportfoliobyportfolio()'>
                                        <option selected="selected" [ngValue]="All">All</option>
                                        <option *ngFor="let pitem of portfoliolist" title="portfolio1"
                                            [ngValue]="pitem.id" name='p1'>
                                            {{pitem.name}} </option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class='row align-items-center ml-2 mr-2 mt-3'>
                        <div class="col-lg-9">
                            <label style="color: #000034">Show</label>
                            <select class="custom-select" style="width: auto;margin: 0 10px;" name="pageSize"
                                [(ngModel)]="fundservice.pageSize">
                                <option [ngValue]="10">10</option>
                                <option [ngValue]="25">25</option>
                                <option [ngValue]="50">50</option>
                                <option [ngValue]="100">100</option>
                            </select>
                            <label style="color: #000034">Entries</label>
                        </div>
                        <div class="col-lg-3">
                            <span
                                class="form-group load-content d-flex justify-content-between align-items-center ml-auto mb-0 w-60 search_box"
                                style="color: #000034">
                                <span class="ml-3 load-span" *ngIf="fundservice.loading$ | async">Loading...</span>
                                Search: <input class="form-control search ml-2 " type="text" name="searchTerm"
                                    [(ngModel)]="fundservice.searchTerm" />
                            </span>
                        </div>
                    </div>

                    <table id="security-table" class="width-100 trade-datatables">
                        <thead>
                            <tr>
                                <th scope="col" sortable="security_name" (sort)="onSort($event)">Security
                                    <i class="fa fa-chevron-up"></i><i class="fa fa-chevron-down"></i></th>
                                <th scope="col" sortable="asset_type" (sort)="onSort($event)">Assets type <i
                                        class="fa fa-chevron-up"></i><i class="fa fa-chevron-down"></i></th>
                                <th scope="col" sortable="isin" (sort)="onSort($event)">ISIN <i
                                        class="fa fa-chevron-up"></i><i class="fa fa-chevron-down"></i></th>
                                <th scope="col" sortable="quantity" (sort)="onSort($event)">Quantity</th>
                                <th>Price</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let fund of fundlist;let i = index;">
                                <td>
                                    <input *ngIf="fund.security == '' " [(ngModel)]="securityinput[i]"
                                        id='security_{{i}}' (keyup)="searchsecurity($event)" list="securityname"
                                        name='security_{{i}}' (change)="currentUser ? setrowdata(fund,i) : null"
                                        type="text">
                                    <datalist id="securityname">
                                        <option *ngFor="let security of securitylist;let d = index"
                                            data-value='{{security.name}}' data-id={{security.id}}>
                                            Name:{{security.name}} Isin:{{security.isin}}
                                            Ticker:{{security.ticker}}
                                        </option>
                                    </datalist>
                                    <span *ngIf="fund.security_name != ''"
                                        style="width: 3cm">{{fund.security_name}}</span>
                                </td>
                                <td>{{fund.asset_type}}</td>
                                <td>{{fund.isin}}</td>
                                <td><input type="text" class="form-control" [(ngModel)]="fund.quantity"
                                        name='quantity_{{i}}' style="text-align: center; width: 130px"
                                        (keypress)="numberOnly($event)" (change)='updatefundquantity(fund)'></td>
                                <td><input type="text" class="form-control" [(ngModel)]="fund.price"
                                        name='quantity_{{i}}' style="text-align: center; width: 130px"
                                        (keypress)="numberOnly($event)" (change)='updateprice(fund)'
                                        (click)="fund.price === 0 ? fund.price = '' : null "
                                        (blur)="fund.price === '' ? fund.price = 0 : null"></td>
                                <td>
                                    <button type="button" class="btn btn-outline-danger"
                                        (click)="delete_Portfolio(fund)">Delete</button>
                                </td>
                            </tr>
                            <div *ngIf="fundlist && fundlist.length === 0" style="text-align:center; color:red; position: absolute;
                            left: 0; right: 0">No data found in selected category.</div>
                        </tbody>
                    </table>

                    <div class="d-flex">
                        <ngb-pagination class="ml-auto" [collectionSize]="total" [(page)]="fundservice.page"
                            [pageSize]="fundservice.pageSize">
                        </ngb-pagination>
                    </div>

                    <div class="upload-wrap d-flex">
                        <form class="ml-auto d-inline-flex">
                            <div class="input-file-wrap">
                                <button type="button" (click)="currentUser ? openmodal(upload,'upload') : null"
                                    class="upload-btn trade-btn green-btn d-flex align-items-center justify-content-center"
                                    data-toggle="modal" data-target="#uploadpop">
                                    <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg"
                                        xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                                        viewBox="0 0 548.176 548.176" style="enable-background:new 0 0 548.176 548.176;"
                                        xml:space="preserve">
                                        <g>
                                            <path
                                                d="M524.326,297.352c-15.896-19.89-36.21-32.782-60.959-38.684c7.81-11.8,11.704-24.934,11.704-39.399 c0-20.177-7.139-37.401-21.409-51.678c-14.273-14.272-31.498-21.411-51.675-21.411c-18.083,0-33.879,5.901-47.39,17.703 c-11.225-27.41-29.171-49.393-53.817-65.95c-24.646-16.562-51.818-24.842-81.514-24.842c-40.349,0-74.802,14.279-103.353,42.83 c-28.553,28.544-42.825,62.999-42.825,103.351c0,2.474,0.191,6.567,0.571,12.275c-22.459,10.469-40.349,26.171-53.676,47.106 C6.661,299.594,0,322.43,0,347.179c0,35.214,12.517,65.329,37.544,90.358c25.028,25.037,55.15,37.548,90.362,37.548h310.636 c30.259,0,56.096-10.711,77.512-32.12c21.413-21.409,32.121-47.246,32.121-77.516C548.172,339.944,540.223,317.248,524.326,297.352 z M362.729,289.648c-1.813,1.804-3.949,2.707-6.42,2.707h-63.953v100.502c0,2.471-0.903,4.613-2.711,6.42 c-1.813,1.813-3.949,2.711-6.42,2.711h-54.826c-2.474,0-4.615-0.897-6.423-2.711c-1.804-1.807-2.712-3.949-2.712-6.42V292.355 H155.31c-2.662,0-4.853-0.855-6.563-2.563c-1.713-1.714-2.568-3.904-2.568-6.566c0-2.286,0.95-4.572,2.852-6.855l100.213-100.21 c1.713-1.714,3.903-2.57,6.567-2.57c2.666,0,4.856,0.856,6.567,2.57l100.499,100.495c1.714,1.712,2.562,3.901,2.562,6.571 C365.438,285.696,364.535,287.845,362.729,289.648z" />
                                        </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                    </svg>
                                    Upload</button>
                            </div>
                            <button type="button" class="upload-icon-btn"
                                (click)="openmodal(selectPortfolio, 'select portfolio')" style="cursor: pointer">
                                <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg"
                                    xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                                    viewBox="0 0 491.86 491.86" style="enable-background:new 0 0 491.86 491.86;"
                                    xml:space="preserve">
                                    <g>
                                        <g>
                                            <path
                                                d="M465.167,211.614H280.245V26.691c0-8.424-11.439-26.69-34.316-26.69s-34.316,18.267-34.316,26.69v184.924H26.69 C18.267,211.614,0,223.053,0,245.929s18.267,34.316,26.69,34.316h184.924v184.924c0,8.422,11.438,26.69,34.316,26.69 s34.316-18.268,34.316-26.69V280.245H465.17c8.422,0,26.69-11.438,26.69-34.316S473.59,211.614,465.167,211.614z" />
                                        </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                    </g>
                                    <g> </g>
                                    <g> </g>
                                    <g> </g>
                                    <g> </g>
                                    <g> </g>
                                    <g> </g>
                                    <g> </g>
                                    <g> </g>
                                    <g> </g>
                                    <g> </g>
                                    <g> </g>
                                    <g> </g>
                                    <g> </g>
                                    <g> </g>
                                    <g> </g>
                                </svg>
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <ng-template #selectPortfolio let-modal>
            <div class="modal-header">
                <h4 class="modal-title" id="modal-basic-title" style="color: white">Select portfolio</h4>
                <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class='login-form trade-inputs'>
                    <form>
                        <div class="input-group">
                            <label style="color: black; margin-top: 7px;">Select Portfolio : &nbsp;&nbsp;</label>
                            <select style="width:130px" id='portfolio' class='form-control' name='selected'
                                title="Select Portfolio" [(ngModel)]="selectedp">
                                <option *ngFor="let pitem of portfoliolist" title="portfolio1" [value]="pitem.id"
                                    name='p1'>
                                    {{pitem.name}} </option>
                            </select>
                        </div>
                        <br>
                        <button type="button" (click)="modal.close('Save click');addRow()"
                            class="trade-btn green-btn d-flex align-items-center justify-content-center login-email">
                            <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg"
                                xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 512 512"
                                style="enable-background:new 0 0 512 512;" xml:space="preserve">
                                <path
                                    d="M131.5,472H60.693c-8.538,0-13.689-4.765-15.999-7.606c-3.988-4.906-5.533-11.29-4.236-17.519 c20.769-99.761,108.809-172.616,210.445-174.98c1.693,0.063,3.39,0.105,5.097,0.105c1.722,0,3.434-0.043,5.142-0.107 c24.853,0.567,49.129,5.24,72.236,13.917c10.34,3.885,21.871-1.352,25.754-11.693c3.883-10.34-1.352-21.871-11.693-25.754 c-3.311-1.244-6.645-2.408-9.995-3.512C370.545,220.021,392,180.469,392,136C392,61.01,330.991,0,256,0 c-74.991,0-136,61.01-136,136c0,44.509,21.492,84.092,54.643,108.918c-30.371,9.998-58.871,25.546-83.813,46.062 c-45.732,37.617-77.529,90.086-89.532,147.743c-3.762,18.066,0.744,36.622,12.363,50.908C25.221,503.847,42.364,512,60.693,512 H131.5c11.046,0,20-8.954,20-20C151.5,480.954,142.546,472,131.5,472z M160,136c0-52.935,43.065-96,96-96s96,43.065,96,96 c0,51.367-40.554,93.438-91.326,95.885c-1.557-0.028-3.114-0.052-4.674-0.052c-1.564,0-3.127,0.023-4.689,0.051 C200.546,229.43,160,187.362,160,136z" />
                                <path
                                    d="M496.689,344.607c-8.561-19.15-27.845-31.558-49.176-31.607h-62.372c-0.045,0-0.087,0-0.133,0 c-22.5,0-42.13,13.26-50.029,33.807c-1.051,2.734-2.336,6.178-3.677,10.193H200.356c-5.407,0-10.583,2.189-14.35,6.068 l-34.356,35.388c-7.567,7.794-7.529,20.203,0.085,27.95l35,35.612c3.76,3.826,8.9,5.981,14.264,5.981h65c11.046,0,20-8.954,20-20 c0-11.046-8.954-20-20-20h-56.614l-15.428-15.698L208.814,397h137.491c9.214,0,17.235-6.295,19.426-15.244 c1.618-6.607,3.648-12.959,6.584-20.596c1.936-5.036,6.798-8.16,12.741-8.16c0.013,0,0.026,0,0.039,0h62.371 c5.656,0.013,10.524,3.053,12.705,7.932c5.369,12.012,11.78,30.608,11.828,50.986c0.048,20.529-6.356,39.551-11.739,51.894 c-2.17,4.978-7.079,8.188-12.56,8.188c-0.011,0-0.022,0-0.033,0h-63.125c-5.533-0.013-10.716-3.573-12.896-8.858 c-2.339-5.671-4.366-12.146-6.197-19.797c-2.571-10.742-13.367-17.366-24.105-14.796c-10.743,2.571-17.367,13.364-14.796,24.106 c2.321,9.699,4.978,18.118,8.121,25.738c8.399,20.364,27.939,33.555,49.827,33.606h63.125c0.043,0,0.083,0,0.126,0 c21.351-0.001,40.647-12.63,49.18-32.201c6.912-15.851,15.137-40.511,15.072-67.975 C511.935,384.434,503.638,360.153,496.689,344.607z" />
                                <circle cx="431" cy="412" r="20" />
                            </svg>
                            Save
                        </button>
                    </form>
                </div>
            </div>
        </ng-template>

        <ng-template #upload let-modal>
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" (click)="modal.dismiss('Cross click')"
                    aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="upload-body" (click)="fileInput.click()" appDragDrop (onFileDropped)="uploadFile($event)">
                    <form action="post" class="d-flex align-items-center justify-content-center">
                        <p>Drag & Drop Files <br>(Excel or CSV)</p>
                        <input type="file" #fileInput (change)="uploadFile($event.target.files)">

                    </form>
                </div>
                <div class="upload-options ">
                    <ul class="d-flex align-items-center justify-content-between">
                        <li>
                            <div #container style="display:inline-block;position:relative">
                                <a (click)='dropboxupload()' pTooltip="Dropbox" tooltipPosition="bottom"
                                    [appendTo]="container">
                                    <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg"
                                        xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="475.078px"
                                        height="475.077px" viewBox="0 0 475.078 475.077"
                                        style="enable-background:new 0 0 475.078 475.077;" xml:space="preserve">
                                        <g>
                                            <g>
                                                <polygon
                                                    points="139.899,353.459 237.539,272.087 96.501,185.005 0,262.382 		" />
                                                <polygon
                                                    points="237.539,272.08 335.467,353.452 475.078,262.375 378.58,185.005 		" />
                                                <polygon
                                                    points="238.111,289.786 238.111,289.212 237.827,289.499 237.539,289.212 237.539,289.786 139.899,370.871 97.928,343.463 97.928,374.293 237.539,457.951 237.539,458.235 237.827,457.951 238.111,458.235 238.111,457.951 378.008,374.293 378.008,343.463 336.036,370.871 		" />
                                                <polygon
                                                    points="0,107.917 96.501,185.005 237.539,98.212 139.899,16.842 		" />
                                                <polygon
                                                    points="335.467,16.842 237.539,98.212 378.58,185.005 475.078,107.917 		" />
                                            </g>
                                        </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                    </svg>
                                </a>
                            </div>
                        </li>
                        <li>
                            <div #container1 style="display:inline-block;position:relative">
                                <a (click)='drive_fileupload()' pTooltip="Google drive" tooltipPosition="bottom"
                                    [appendTo]="container1">
                                    <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg"
                                        xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                                        viewBox="0 0 508.52 508.52" style="enable-background:new 0 0 508.52 508.52;"
                                        xml:space="preserve">
                                        <g>
                                            <g>
                                                <g>
                                                    <g>
                                                        <polygon style="fill:#010002;"
                                                            points="484.492,284.58 339.024,32.577 169.496,32.577 314.996,284.58 				" />
                                                        <polygon style="fill:#010002;"
                                                            points="145.437,74.276 0,326.279 84.764,473.05 230.169,221.143 				" />
                                                        <polygon style="fill:#010002;"
                                                            points="234.396,316.363 143.371,475.943 423.756,475.943 508.52,316.363 				" />
                                                    </g>
                                                </g>
                                            </g>
                                        </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                    </svg>
                                </a>
                            </div>
                        </li>
                        <li>
                            <div #container2 style="display:inline-block;position:relative">
                                <a (click)='onedrivefileupload()' pTooltip="One Drive" tooltipPosition="bottom"
                                    [appendTo]="container2">
                                    <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg"
                                        xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 512 512"
                                        style="enable-background:new 0 0 512 512;" xml:space="preserve">
                                        <g>
                                            <g>
                                                <path
                                                    d="M450.959,275.302c-4.8-31.303-25.794-57.333-54.127-69.272C396.095,140.822,342.829,88,277.45,88 c-32.78,0-63.667,13.272-86.141,36.72c-6.484-1.276-13.082-1.92-19.709-1.92c-51.554,0-94.297,38.443-101.066,88.169 C30.558,217.688,0,252.543,0,294.4C0,341.048,37.952,379,84.6,379h28.681c11.597,26.461,38.027,45,68.719,45h255 c41.355,0,75-33.645,75-75C512,312.413,485.669,281.861,450.959,275.302z M107,349H84.6C54.494,349,30,324.506,30,294.4 s24.494-54.6,54.6-54.6h15v-15c0-39.701,32.299-72,72-72c6.99,0,13.932,1.015,20.634,3.016l9.588,2.864l6.326-7.753 C225.224,130.001,250.483,118,277.45,118c46.502,0,84.819,35.689,89.013,81.115C364.984,199.042,363.497,199,362,199 c-5.471,0-10.917,0.497-16.281,1.483C326.024,180.367,299.198,169,270.75,169c-57.897,0-105,47.103-105,105 c0,0.589,0.005,1.179,0.015,1.77C132.188,283.208,107,313.218,107,349z M437,394H182c-24.813,0-45-20.187-45-45 s20.188-45,45.001-45h17.728l-2.935-17.483c-0.693-4.129-1.044-8.341-1.044-12.517c0-41.355,33.645-75,75-75 c22.623,0,43.814,10.069,58.14,27.625l6.327,7.752l9.587-2.864C350.388,229.846,356.173,229,362,229c33.084,0,60,26.916,60,60v15 h15c24.813,0,45,20.187,45,45S461.813,394,437,394z" />
                                            </g>
                                        </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                        <g> </g>
                                    </svg>
                                </a>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </ng-template>

    </div>
</div>