<!-- right panel -->
<div class="right-panel-wrap no-padding-right">
    <!-- Fund content -->
    <div class="dashboard-content">
        <div class="row">
            <div class="col-lg-12">
                <div class="block-container">
                    <div class="head-global">
                        <h3>Holding <span>Details List</span></h3>
                    </div>
                    <div class="">
                        <div class='row'>
                            <div class='input-group align-items-center col-sm-4'>
                                Select Portlolios:<select class='form-control' [(ngModel)]="sortlist.searchTerm">
                                    <option selected value="">All</option>
                                    <option *ngFor="let pitem of portfoliolist" title="portfolio1" [value]="pitem.name"
                                        name='p1'>
                                        {{pitem.name}} </option>
                                </select>
                            </div>
                            <div class="table-btns col-sm-8">
                                <form action="post" class="form-holding">
                                    <button type="button" (click)="openModal(addHoldingDetais)" style="cursor: pointer"
                                        class="tbl-btn button green-btn">
                                        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg"
                                            xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                                            viewBox="0 0 491.86 491.86" style="enable-background:new 0 0 491.86 491.86;"
                                            xml:space="preserve">
                                            <g>
                                                <g>
                                                    <path
                                                        d="M465.167,211.614H280.245V26.691c0-8.424-11.439-26.69-34.316-26.69s-34.316,18.267-34.316,26.69v184.924H26.69 C18.267,211.614,0,223.053,0,245.929s18.267,34.316,26.69,34.316h184.924v184.924c0,8.422,11.438,26.69,34.316,26.69 s34.316-18.268,34.316-26.69V280.245H465.17c8.422,0,26.69-11.438,26.69-34.316S473.59,211.614,465.167,211.614z" />
                                                </g>
                                                <g> </g>
                                                <g> </g>
                                                <g> </g>
                                                <g> </g>
                                                <g> </g>
                                                <g> </g>
                                                <g> </g>
                                                <g> </g>
                                                <g> </g>
                                                <g> </g>
                                                <g> </g>
                                                <g> </g>
                                                <g> </g>
                                                <g> </g>
                                                <g> </g>
                                            </g>
                                            <g> </g>
                                            <g> </g>
                                            <g> </g>
                                            <g> </g>
                                            <g> </g>
                                            <g> </g>
                                            <g> </g>
                                            <g> </g>
                                            <g> </g>
                                            <g> </g>
                                            <g> </g>
                                            <g> </g>
                                            <g> </g>
                                            <g> </g>
                                            <g> </g>
                                        </svg>
                                        Add Row
                                    </button>
                                    <button type="button" (click)="downloadData()" class="tbl-btn  dark-green-btn"
                                        style="cursor: pointer">
                                        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg"
                                            xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                                            viewBox="0 0 475.078 475.077"
                                            style="enable-background:new 0 0 475.078 475.077;" xml:space="preserve">
                                            <g>
                                                <g>
                                                    <path
                                                        d="M467.083,318.627c-5.324-5.328-11.8-7.994-19.41-7.994H315.195l-38.828,38.827c-11.04,10.657-23.982,15.988-38.828,15.988 c-14.843,0-27.789-5.324-38.828-15.988l-38.543-38.827H27.408c-7.612,0-14.083,2.669-19.414,7.994 C2.664,323.955,0,330.427,0,338.044v91.358c0,7.614,2.664,14.085,7.994,19.414c5.33,5.328,11.801,7.99,19.414,7.99h420.266 c7.61,0,14.086-2.662,19.41-7.99c5.332-5.329,7.994-11.8,7.994-19.414v-91.358C475.078,330.427,472.416,323.955,467.083,318.627z M360.025,414.841c-3.621,3.617-7.905,5.424-12.854,5.424s-9.227-1.807-12.847-5.424c-3.614-3.617-5.421-7.898-5.421-12.844 c0-4.948,1.807-9.236,5.421-12.847c3.62-3.62,7.898-5.431,12.847-5.431s9.232,1.811,12.854,5.431 c3.613,3.61,5.421,7.898,5.421,12.847C365.446,406.942,363.638,411.224,360.025,414.841z M433.109,414.841 c-3.614,3.617-7.898,5.424-12.848,5.424c-4.948,0-9.229-1.807-12.847-5.424c-3.613-3.617-5.42-7.898-5.42-12.844 c0-4.948,1.807-9.236,5.42-12.847c3.617-3.62,7.898-5.431,12.847-5.431c4.949,0,9.233,1.811,12.848,5.431 c3.617,3.61,5.427,7.898,5.427,12.847C438.536,406.942,436.729,411.224,433.109,414.841z" />
                                                    <path
                                                        d="M224.692,323.479c3.428,3.613,7.71,5.421,12.847,5.421c5.141,0,9.418-1.808,12.847-5.421l127.907-127.908 c5.899-5.519,7.234-12.182,3.997-19.986c-3.23-7.421-8.847-11.132-16.844-11.136h-73.091V36.543c0-4.948-1.811-9.231-5.421-12.847 c-3.62-3.617-7.901-5.426-12.847-5.426h-73.096c-4.946,0-9.229,1.809-12.847,5.426c-3.615,3.616-5.424,7.898-5.424,12.847V164.45 h-73.089c-7.998,0-13.61,3.715-16.846,11.136c-3.234,7.801-1.903,14.467,3.999,19.986L224.692,323.479z" />
                                                </g>
                                            </g>
                                            <g> </g>
                                            <g> </g>
                                            <g> </g>
                                            <g> </g>
                                            <g> </g>
                                            <g> </g>
                                            <g> </g>
                                            <g> </g>
                                            <g> </g>
                                            <g> </g>
                                            <g> </g>
                                            <g> </g>
                                            <g> </g>
                                            <g> </g>
                                            <g> </g>
                                        </svg>
                                        Download data as CSV
                                    </button>
                                </form>
                            </div>
                        </div>
                        <br />
                        <div class='row align-items-center ml-2 mr-2'>
                            Show
                            <select class="custom-select" style="width: auto;margin: 0 10px;" name="pageSize"
                                [(ngModel)]="sortlist.pageSize">
                                <option [ngValue]="10">10</option>
                                <option [ngValue]="25">25</option>
                                <option [ngValue]="50">50</option>
                                <option [ngValue]="100">100</option>
                            </select>
                            Entries

                            <span class="form-group d-flex align-items-center ml-auto mb-0 w-60">
                                Search: <input class="form-control search ml-2 w-100" type="text" name="searchTerm"
                                    [(ngModel)]="sortlist.searchTerm" />
                                <span class="ml-3" *ngIf="sortlist.loading$ | async">Loading...</span>
                            </span>
                        </div>

                        <div class="scrollauto">
                            <table id="holding-table" class="trade-datatables nowrap">
                                <thead>
                                    <tr>
                                        <th scope="col" sortable="portfolio" (sort)="onSort($event)">Portfolio</th>
                                        <th scope="col" sortable="security" (sort)="onSort($event)">Security</th>
                                        <th scope="col" sortable="isin" (sort)="onSort($event)">ISIN</th>
                                        <th scope="col" sortable="ticker" (sort)="onSort($event)">Ticker</th>
                                        <th scope="col" sortable="quantity" (sort)="onSort($event)">Quantity</th>
                                        <th scope="col" sortable="current_price" (sort)="onSort($event)">Current Price
                                        </th>
                                        <th scope="col" sortable="market_value" (sort)="onSort($event)">MKt value</th>
                                        <th scope="col" sortable="basic_price" (sort)="onSort($event)">Basic Price</th>
                                        <th scope="col" sortable="basis" (sort)="onSort($event)">Basis</th>
                                        <th scope="col" sortable="country" (sort)="onSort($event)">Country</th>
                                        <th scope="col" sortable="currency" (sort)="onSort($event)">Currency</th>
                                        <th scope="col" sortable="asset_class" (sort)="onSort($event)">Asset Class </th>
                                        <th scope="col" sortable="industry" (sort)="onSort($event)">Industry</th>
                                        <th scope="col" sortable="rating" (sort)="onSort($event)">Rating</th>

                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- {{HoldingDetailList}} -->
                                    <tr *ngFor="let item of HoldingDetailList ; let i = index">

                                        <td>{{item.portfolio}}</td>
                                        <td>{{item.security}}</td>
                                        <td>{{item.isin}}</td>
                                        <td>{{item.ticker}}</td>
                                        <td>{{item.quantity}}</td>
                                        <td><input class="form-control" *ngIf="item.current_price === null"
                                                type="number" style="width: 2cm;text-align: center"
                                                [(ngModel)]="currentprice[i]"
                                                (blur)="item.current_price=currentprice[i];UpdateHoldingDetails(item,i)"
                                                name="current_price_{{i}}" oninput="validity.valid||(value='');">
                                            <span *ngIf="item.current_price !== null">{{item.current_price}}</span>
                                        </td>
                                        <td>{{(item.market_value)}}</td>
                                        <td><input class="form-control" *ngIf="item.basic_price === null" type="number"
                                                style=" width: 2cm;text-align:
                                                center" [(ngModel)]="basicprice[i]"
                                                (blur)="item.basic_price = basicprice[i];UpdateHoldingDetails(item,i)"
                                                name="basic_price_{{i}}" oninput="validity.valid||(value='');">
                                            <span *ngIf="item.basic_price !== null">{{item.basic_price}}</span>
                                        </td>
                                        <td>{{item.basis}}</td>
                                        <td><input *ngIf="item.country === null" [(ngModel)]="country[i]"
                                                style="width: 2cm;text-align: center" name="country_{{i}}"
                                                (change)="item.country=country[i];UpdateHoldingDetails(item,i)">
                                            <span *ngIf="item.country !== null">{{item.country}}</span>

                                        </td>
                                        <td><input *ngIf="item.currency === null" [(ngModel)]="currency[i]"
                                                style="width: 2cm;text-align: center" name='currency_{{i}}'
                                                (change)="item.currency = currency[i];UpdateHoldingDetails(item,i)">
                                            <span *ngIf="item.currency !== null">{{item.currency}}</span>

                                        </td>
                                        <td>{{item.asset_class}}</td>
                                        <td><input class="form-control" *ngIf="item.industry === null"
                                                [(ngModel)]="industry[i]" style="width: 4cm;text-align: center"
                                                name='industry_{{i}}'
                                                (change)="item.industry=industry[i];UpdateHoldingDetails(item,i)">
                                            <span *ngIf="item.industry !== null">{{item.industry}}</span>

                                        </td>
                                        <td><input class="form-control" *ngIf="item.rating === null"
                                                [(ngModel)]="rating[i]" style="width: 4cm;text-align: center"
                                                name='rating_{{i}}'
                                                (change)="item.rating = rating[i];UpdateHoldingDetails(item,i)">
                                            <span *ngIf="item.rating !== null">{{item.rating}}</span>

                                        </td>

                                    </tr>

                                </tbody>
                            </table>

                        </div>
                        <div>
                            <br />
                            <!-- Showing {{sortlist.pageSize}} records from {{total}} -->
                            <div class="d-flex ">
                                <ngb-pagination class="ml-auto" [collectionSize]="total" [(page)]="sortlist.page"
                                    [pageSize]="sortlist.pageSize">
                                </ngb-pagination>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Fund content -->

</div>

<ng-template #addHoldingDetais role="document">
    <!-- #addHoldingDetais -->
    <div class="modal-header">
        <div class="pop-logo">
            <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                x="0px" y="0px" viewBox="0 0 486.742 486.742" style="enable-background:new 0 0 486.742 486.742;"
                xml:space="preserve">
                <g>
                    <g>
                        <path
                            d="M33,362.371v78.9c0,4.8,3.9,8.8,8.8,8.8h61c4.8,0,8.8-3.9,8.8-8.8v-138.8l-44.3,44.3 C57.9,356.071,45.9,361.471,33,362.371z" />
                        <path
                            d="M142,301.471v139.8c0,4.8,3.9,8.8,8.8,8.8h61c4.8,0,8.8-3.9,8.8-8.8v-82.3c-13.9-0.3-26.9-5.8-36.7-15.6L142,301.471z" />
                        <path
                            d="M251,350.271v91c0,4.8,3.9,8.8,8.8,8.8h61c4.8,0,8.8-3.9,8.8-8.8v-167.9l-69.9,69.9 C257,345.971,254.1,348.271,251,350.271z" />
                        <path
                            d="M432.7,170.171l-72.7,72.7v198.4c0,4.8,3.9,8.8,8.8,8.8h61c4.8,0,8.8-3.9,8.8-8.8v-265.6c-2-1.7-3.5-3.2-4.6-4.2 L432.7,170.171z" />
                        <path
                            d="M482.6,41.371c-2.9-3.1-7.3-4.7-12.9-4.7c-0.5,0-1.1,0-1.6,0c-28.4,1.3-56.7,2.7-85.1,4c-3.8,0.2-9,0.4-13.1,4.5 c-1.3,1.3-2.3,2.8-3.1,4.6c-4.2,9.1,1.7,15,4.5,17.8l7.1,7.2c4.9,5,9.9,10,14.9,14.9l-171.6,171.7l-77.1-77.1 c-4.6-4.6-10.8-7.2-17.4-7.2c-6.6,0-12.7,2.6-17.3,7.2L7.2,286.871c-9.6,9.6-9.6,25.1,0,34.7l4.6,4.6c4.6,4.6,10.8,7.2,17.4,7.2 s12.7-2.6,17.3-7.2l80.7-80.7l77.1,77.1c4.6,4.6,10.8,7.2,17.4,7.2c6.6,0,12.7-2.6,17.4-7.2l193.6-193.6l21.9,21.8 c2.6,2.6,6.2,6.2,11.7,6.2c2.3,0,4.6-0.6,7-1.9c1.6-0.9,3-1.9,4.2-3.1c4.3-4.3,5.1-9.8,5.3-14.1c0.8-18.4,1.7-36.8,2.6-55.3 l1.3-27.7C487,49.071,485.7,44.571,482.6,41.371z" />
                    </g>
                </g>
                <g> </g>
                <g> </g>
                <g> </g>
                <g> </g>
                <g> </g>
                <g> </g>
                <g> </g>
                <g> </g>
                <g> </g>
                <g> </g>
                <g> </g>
                <g> </g>
                <g> </g>
                <g> </g>
                <g> </g>
            </svg>
        </div>
        <div class="pop-head">
            <h3>Add Holding Detail</h3>
        </div>
    </div>
    <div class="modal-body">
        <div class="login-with-btn">

            <div class="login-form trade-inputs">

                <form id='regform' [formGroup]='fundForm' action="post">

                    <div class="input-group">
                        <!-- <label class="form-control label">Select Portfolio:</label> -->
                        <input class="form-control" id='portfolio' name='selected' title="
                                Select Portfolio" formControlName="selectedPortfolio" placeholder="select Portfolio"
                            list="portfolioselect"
                            [ngClass]="{ 'is-invalid': submitted && f.selectedPortfolio.errors }">
                        <datalist id="portfolioselect">
                            <option *ngFor="let pitem of portfoliolist" [value]="pitem.name">
                                {{pitem.name}} </option>

                        </datalist>

                        <div *ngIf="submitted && f.selectedPortfolio.errors" class="invalid-feedback">
                            <div *ngIf="f.selectedPortfolio.errors.required">Select Portfolio</div>
                        </div>
                    </div>
                    <br />
                    <div class="input-group">
                        <input placeholder="select security" class="form-control " (keyup)="searchsecurity($event)"
                            list="securityname" type="text" (change)="setSecurity()" id='secinput'
                            formControlName="selectedSecurity"
                            [ngClass]="{ 'is-invalid': submitted && f.selectedSecurity.errors }">

                        <datalist id="securityname">
                            <option *ngFor="let security of securitylist;let d = index" data-value={{security.name}}
                                data-id={{security.id}}>
                                <!-- title="{{security.name}} Isin:{{security.isin}} Ticker:{{security.ticker}}"> -->
                                Name:{{security.name}} Isin:{{security.isin}}
                                Ticker:{{security.ticker}} {{security.id}}
                            </option>
                        </datalist>
                        <div *ngIf="submitted && f.selectedSecurity.errors" class="invalid-feedback">
                            <div *ngIf="f.selectedSecurity.errors.required">Security is required</div>
                        </div>
                    </div>
                    <br />

                    <div class="input-group">
                        <input oninput="validity.valid||(value='');" type="number" class="form-control" formControlName="quantity" name='quantity'
                            placeholder="Enter Quantity" [ngClass]="{ 'is-invalid': submitted && f.quantity.errors }">
                        <div *ngIf="submitted && f.quantity.errors" class="invalid-feedback">
                            <div *ngIf="f.quantity.errors.required">Quantity is required</div>
                            <div *ngIf="f.quantity.errors.pattern">Quantity in numbers only</div>
                        </div>
                    </div>
                    <br />
                    <div class="input-group">
                        <input type="number" class="form-control" [ngModelOptions]="{standalone: true}"
                            name='inputBasicPrice' [(ngModel)]=" inputBasicPrice" placeholder="Enter Basic Price">

                    </div>
                    <br />
                    <div class="input-group">
                        <input type="number" class="form-control" [ngModelOptions]="{standalone: true}"
                            name='inputCurrentPrice' [(ngModel)]="
                            inputCurrentPrice" placeholder="Enter Current Price">

                    </div>
                    <br />
                    <p>
                        Basic Price and Current Price are not mandatory.
                    </p>
                    <button type="button" (click)='addDetail()' style="cursor: pointer"
                        class="trade-btn button green-btn d-flex align-items-center justify-content-center login-email">
                        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg"
                            xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 512 512"
                            style="enable-background:new 0 0 512 512;" xml:space="preserve">
                            <path
                                d="M131.5,472H60.693c-8.538,0-13.689-4.765-15.999-7.606c-3.988-4.906-5.533-11.29-4.236-17.519 c20.769-99.761,108.809-172.616,210.445-174.98c1.693,0.063,3.39,0.105,5.097,0.105c1.722,0,3.434-0.043,5.142-0.107 c24.853,0.567,49.129,5.24,72.236,13.917c10.34,3.885,21.871-1.352,25.754-11.693c3.883-10.34-1.352-21.871-11.693-25.754 c-3.311-1.244-6.645-2.408-9.995-3.512C370.545,220.021,392,180.469,392,136C392,61.01,330.991,0,256,0 c-74.991,0-136,61.01-136,136c0,44.509,21.492,84.092,54.643,108.918c-30.371,9.998-58.871,25.546-83.813,46.062 c-45.732,37.617-77.529,90.086-89.532,147.743c-3.762,18.066,0.744,36.622,12.363,50.908C25.221,503.847,42.364,512,60.693,512 H131.5c11.046,0,20-8.954,20-20C151.5,480.954,142.546,472,131.5,472z M160,136c0-52.935,43.065-96,96-96s96,43.065,96,96 c0,51.367-40.554,93.438-91.326,95.885c-1.557-0.028-3.114-0.052-4.674-0.052c-1.564,0-3.127,0.023-4.689,0.051 C200.546,229.43,160,187.362,160,136z" />
                            <path
                                d="M496.689,344.607c-8.561-19.15-27.845-31.558-49.176-31.607h-62.372c-0.045,0-0.087,0-0.133,0 c-22.5,0-42.13,13.26-50.029,33.807c-1.051,2.734-2.336,6.178-3.677,10.193H200.356c-5.407,0-10.583,2.189-14.35,6.068 l-34.356,35.388c-7.567,7.794-7.529,20.203,0.085,27.95l35,35.612c3.76,3.826,8.9,5.981,14.264,5.981h65c11.046,0,20-8.954,20-20 c0-11.046-8.954-20-20-20h-56.614l-15.428-15.698L208.814,397h137.491c9.214,0,17.235-6.295,19.426-15.244 c1.618-6.607,3.648-12.959,6.584-20.596c1.936-5.036,6.798-8.16,12.741-8.16c0.013,0,0.026,0,0.039,0h62.371 c5.656,0.013,10.524,3.053,12.705,7.932c5.369,12.012,11.78,30.608,11.828,50.986c0.048,20.529-6.356,39.551-11.739,51.894 c-2.17,4.978-7.079,8.188-12.56,8.188c-0.011,0-0.022,0-0.033,0h-63.125c-5.533-0.013-10.716-3.573-12.896-8.858 c-2.339-5.671-4.366-12.146-6.197-19.797c-2.571-10.742-13.367-17.366-24.105-14.796c-10.743,2.571-17.367,13.364-14.796,24.106 c2.321,9.699,4.978,18.118,8.121,25.738c8.399,20.364,27.939,33.555,49.827,33.606h63.125c0.043,0,0.083,0,0.126,0 c21.351-0.001,40.647-12.63,49.18-32.201c6.912-15.851,15.137-40.511,15.072-67.975 C511.935,384.434,503.638,360.153,496.689,344.607z" />
                            <circle cx="431" cy="412" r="20" />
                        </svg>
                        Add Holding Details
                    </button>
                </form>
            </div>
        </div>
    </div>
</ng-template>